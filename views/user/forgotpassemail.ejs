<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Forgot Password</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="/css/login.css" />
  </head>
  <body class="loginbody">
    <div class="container logincontainer mt-5">
      <h2 class="text-center mb-4">Forgot Password</h2>
      <!-- Forgot Password form -->
      <form id="forgotPasswordForm" action="/forgot-password" method="POST">
        <div class="mb-3">
          <label for="forgotPasswordEmail" class="form-label">Email</label>
          <input
            type="text"
            class="form-control"
            id="forgotPasswordEmail"
            name="email"
          />
          <div id="forgotPasswordEmailError" class="invalid-feedback"></div>
        </div>
        <div class="d-grid mb-3">
          <button class="btn btn-primary btn-lg btn-submit" type="submit">
            Submit
          </button>
        </div>
      </form>
      <!-- Back to Login link -->
      <p class="text-center mb-0">
        <a href="/login" class="back-to-login-link">Back to Login</a>
      </p>
      <% if(errorMessage) { %>
      <!-- Error message display -->
      <div class="alert alert-danger mt-3" role="alert">
        <%= errorMessage %>
      </div>
      <% } %>
    </div>
    <!-- JavaScript includes -->
    <script>
      function validateForm() {
        const emailInput = document.getElementById("forgotPasswordEmail");
        const emailError = document.getElementById("forgotPasswordEmailError");

        // Email regex pattern (same as signup page)
        const emailRegex = /^[a-zA-Z0-9._-]+@[a-z]+\.[a-z]{2,}$/;

        // Validate email
        if (!emailInput.value.match(emailRegex)) {
          emailInput.classList.add("is-invalid");
          emailError.textContent = "Please enter a valid email address.";
          emailError.style.display = "block";
          return false;
        } else {
          emailInput.classList.remove("is-invalid");
          emailError.style.display = "none";
          return true;
        }
      }

      // Attach form validation function to form submission event
      const form = document.getElementById("forgotPasswordForm");
      form.addEventListener("submit", function (event) {
        if (!validateForm()) {
          event.preventDefault(); // Prevent form submission if validation fails
        }
      });
    </script>
  </body>
</html>
