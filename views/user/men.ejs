<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Men's Collection</title>
  <link rel="stylesheet" href="/css/style.css" />
  <!-- Bootstrap CSS -->
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Font Awesome CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.16/dist/tailwind.min.css" rel="stylesheet">

  <style>
    :root {
      --gold-primary: #BCA374;
      --gold-secondary: #A38F5F;
      --gold-light: #D4C5A3;
      --white: #FFFFFF;
      --off-white: #F8F9FA;
      --dark: #333333;
    }

    body {
      background-color: var(--white);
      font-family: 'Arial', sans-serif;
    }

    /* Navbar Styles */
    .navbar {
      background-color: var(--white) !important;
      box-shadow: 0 2px 4px rgba(188, 163, 116, 0.1);
      padding: 1rem 2rem;
    }

    .navbar-nav .nav-link {
      color: var(--dark) !important;
      font-weight: 500;
      margin: 0 1rem;
      transition: color 0.3s;
    }

    .navbar-nav .nav-link:hover {
      color: var(--gold-primary) !important;
    }

    .search-input {
      border: 1px solid var(--gold-light);
      border-radius: 20px;
      padding: 0.5rem 1rem;
    }

    .search-icon,
    .wishlist-icon,
    .cart-icon {
      color: var(--gold-primary);
      margin: 0 1rem;
      font-size: 1.2rem;
      transition: color 0.3s;
    }

    .search-icon:hover,
    .wishlist-icon:hover,
    .cart-icon:hover {
      color: var(--gold-secondary);
    }

    /* Filter Section */
    .filter-section {
      background-color: var(--off-white);
      padding: 1.5rem;
      margin: 2rem 0;
      border-radius: 10px;
      border: 1px solid var(--gold-light);
    }

    select,
    .filter-submit-btn {
      border: 1px solid var(--gold-primary);
      border-radius: 20px;
      padding: 0.5rem 1.5rem;
      margin: 0 1rem;
      background-color: var(--white);
      color: var(--dark);
      transition: all 0.3s;
    }

    select:focus {
      outline: none;
      border-color: var(--gold-secondary);
      box-shadow: 0 0 0 0.2rem rgba(188, 163, 116, 0.25);
    }

    .filter-submit-btn {
      background-color: var(--gold-primary);
      color: var(--white);
    }

    .filter-submit-btn:hover {
      background-color: var(--gold-secondary);
    }

    /* Product Cards */
    .section-title h1 {
      color: var(--dark);
      font-size: 2.5rem;
      margin-bottom: 2rem;
      position: relative;
      padding-bottom: 1rem;
    }

    .section-title h1::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 3px;
      background-color: var(--gold-primary);
    }

    .card {
      border: none;
      border-radius: 10px;
      overflow: hidden;
      transition: transform 0.3s, box-shadow 0.3s;
      margin-bottom: 2rem;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(188, 163, 116, 0.2);
    }

    .icons-container {
      position: absolute;
      top: 1rem;
      right: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .card:hover .icons-container {
      opacity: 1;
    }

    .icons-container button {
      background-color: var(--white);
      border-radius: 50%;
      width: 35px;
      height: 35px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .icons-container button i {
      color: var(--gold-primary);
    }

    .product-details {
      padding: 1.5rem;
      text-align: center;
    }

    .product-details h5 {
      color: var(--dark);
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .product-details h6 {
      color: #666;
      font-size: 0.9rem;
    }

    .price {
      margin-top: 1rem;
    }

    .original-price {
      color: #999 !important;
      text-decoration: line-through;
      margin-right: 0.5rem;
    }

    .offer-price {
      color: var(--gold-primary) !important;
      font-weight: 600;
    }

    .stock-status {
      display: block;
      margin-top: 0.5rem;
      font-size: 0.9rem;
    }

    /* Footer */
    .main-footer {
      background-color: var(--off-white);
      padding: 4rem 0;
      margin-top: 4rem;
      border-top: 1px solid var(--gold-light);
    }

    .footer-section h5 {
      color: var(--dark);
      font-weight: 600;
      margin-bottom: 1.5rem;
      position: relative;
      padding-bottom: 0.5rem;
    }

    .footer-section h5::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 50px;
      height: 2px;
      background-color: var(--gold-primary);
    }

    .footer-section ul {
      list-style: none;
      padding: 0;
    }

    .footer-section ul li {
      margin-bottom: 0.8rem;
      color: #666;
      transition: color 0.3s;
      cursor: pointer;
    }

    .footer-section ul li:hover {
      color: var(--gold-primary);
    }

    .social-media-icons {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .social-media-icons a {
      color: var(--dark);
      text-decoration: none;
      transition: color 0.3s;
    }

    .social-media-icons a:hover {
      color: var(--gold-primary);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .navbar {
        padding: 1rem;
      }

      .filter-section {
        flex-direction: column;
        gap: 1rem;
      }

      select,
      .filter-submit-btn {
        width: 100%;
        margin: 0.5rem 0;
      }
    }
  </style>

</head>

<body>
  <!-- Navbar -->
  <%- include('../layouts/header.ejs') %>

  <body>
    <form class="form-inline ml-5 mt-5 mb-5" action="/menfilter" method="GET">

      <label for="price">Price Range:</label>
      <select class="mr-2" name="price" id="price" aria-placeholder="">
        <option value="">Any Price</option> <!-- Empty option -->
        <option value="0-500">0 - 500 Rs</option>
        <option value="500-1000">500 - 1000 Rs</option>
        <option value="1000-2000">1000 - 2000 Rs</option>
        <option value="2000-4000">2000 - 4000 Rs</option>
        <option value="4000-15000">4000 - 15000</option>
        <!-- Add more options as needed -->
      </select>
      <!-- Add sorting dropdown -->
      <label for="sort">Sort By:</label>
      <select class="mr-2" name="sort" id="sort">
        <option value="">Any Sort</option>
        <option value="priceAsc">Price: Low to High</option>
        <option value="priceDesc">Price: High to Low</option>
        <option value="ratings">Average Ratings</option>
        <option value="featured">Featured</option>
        <option value="newArrivals">New Arrivals</option>
        <option value="aToZ">A-Z</option>
        <option value="zToA">Z-A</option>
      </select>

      <button class="filter-submit-btn" type="submit">Apply Filter</button>
    </form>

    <!-- Item Cards -->
    <div>
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-lg-6 text-center">
            <div class="section-title">
              <h1>Men's Collection</h1>
            </div>
          </div>
        </div>


        <div class="row">
          <% for(let j = 0; j < products.length; j++) { %> <% if (j % 4 === 0) {
              %>
        </div>
        <div class="row">
          <!-- Close and reopen row every 4 cards -->
          <% } %>
          <div class="col-md-3 mb-4 col-lg-3">
            <div class="card card-new" data-stock="<%= products[j].stock %>">
              <!-- Add-to-Cart and Wishlist Icons -->
              <div class="icons-container">
                <form action="/add-to-cart/<%= products[j]._id %>" method="POST" class="add-to-cart-form" style="border-color: none">
                  <button type="submit" class="add-to-cart icon" style="border: none; background-color: transparent">
                    <i class="fas fa-shopping-cart"></i>
                  </button>
                </form>
                <form action="/add-to-wishlist/<%= products[j]._id %>" method="POST" class="wishlist-form" style="border-color: none">
                  <button type="submit" class="wishlist-icon" style="border: none; background-color: transparent">
                    <i class="fas fa-heart"></i>
                  </button>
                </form>
              </div>
              <!-- Wrap product card with anchor tag -->
              <a href="/product/<%= products[j]._id %>">
                <img class="img-fluid" src="<%= products[j].image[0].path %>" alt="product image" />
                <div class="product-details">
                  <h5><%= products[j].product %></h5>
                  <h6><%= products[j].description %></h6>
                  <div class="price">
                    <% if (products[j].offerPrice && products[j].offerPrice <
                        products[j].price) { %>
                    <h6 class="original-price" style="color: red">
                      <s><%= products[j].price %></s>
                    </h6>
                    <h6 class="offer-price" style="color: green">
                      offer price: <%= products[j].offerPrice%>
                    </h6>
                    <% } else { %>
                    <h6><%= products[j].price %></h6>
                    <% } %>
                  </div>
                  <span class="stock-status-latest"></span>
                </div>
              </a>
            </div>
          </div>
          <% } %>
        </div>

      </div>
    </div>

    <%- include('../layouts/footer.ejs') %>

    <!-- Bootstrap JS and jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="/js/main.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        const productCards = document.querySelectorAll(".card"); // Select all product cards

        productCards.forEach((card) => {
          const stockStatus = card.querySelector(".stock-status"); // Find the stock status element within the card
          const addToCartButton = card.querySelector(".add-to-cart"); // Find the add-to-cart button within the card

          const stock = parseInt(card.dataset.stock); // Get the stock quantity from the data attribute
          console.log(stock);
          if (stock <= 0) {
            stockStatus.textContent = "Out of Stock";
            stockStatus.style.color = "red";
            addToCartButton.disabled = true;
            addToCartButton.style.display = "none";
          } else if (stock < 5) {
            stockStatus.textContent = `Limited Stock (${stock} left)`;
            stockStatus.style.color = "orange";
          } else {
            stockStatus.textContent = "In Stock";
            stockStatus.style.color = "green";
          }
        });
      });

      document.addEventListener("DOMContentLoaded", function() {
        const productCards = document.querySelectorAll(".card-new"); // Select all product cards

        productCards.forEach((card) => {
          const stockStatus = card.querySelector(".stock-status-latest"); // Find the stock status element within the card
          const addToCartButton = card.querySelector(".add-to-cart"); // Find the add-to-cart button within the card

          const stock = parseInt(card.dataset.stock); // Get the stock quantity from the data attribute
          console.log(stock);
          if (stock <= 0) {
            stockStatus.textContent = "Out of Stock";
            stockStatus.style.color = "red";
            addToCartButton.disabled = true;
            addToCartButton.style.display = "none";
          } else if (stock < 5) {
            stockStatus.textContent = `Limited Stock (${stock} left)`;
            stockStatus.style.color = "orange";
          } else {
            stockStatus.textContent = "In Stock";
            stockStatus.style.color = "green";
          }
        });
      });
    </script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const mobileMenuButton = document.querySelector('.mobile-menu-button');
        const mobileMenu = document.querySelector('.mobile-menu');
        let isMenuOpen = false;

        // Toggle mobile menu
        mobileMenuButton.addEventListener('click', () => {
          isMenuOpen = !isMenuOpen;
          if (isMenuOpen) {
            mobileMenu.classList.remove('hidden');
            // Add slide-down animation
            mobileMenu.style.maxHeight = mobileMenu.scrollHeight + 'px';
          } else {
            // Add slide-up animation
            mobileMenu.style.maxHeight = '0';
            setTimeout(() => {
              mobileMenu.classList.add('hidden');
            }, 300);
          }
        });

        // Smooth scroll for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
          anchor.addEventListener('click', function(e) {
            e.preventDefault();
            document.querySelector(this.getAttribute('href')).scrollIntoView({
              behavior: 'smooth'
            });
          });
        });

        // Add shadow to header on scroll
        window.addEventListener('scroll', () => {
          const header = document.querySelector('nav');
          if (window.scrollY > 0) {
            header.classList.add('shadow-md');
          } else {
            header.classList.remove('shadow-md');
          }
        });
      });

      document.addEventListener('DOMContentLoaded', function() {
        // Update stock status badges
        document.querySelectorAll('.card').forEach(card => {
          const stock = parseInt(card.dataset.stock);
          const statusSpan = card.querySelector('.stock-status');

          if (stock === 0) {
            statusSpan.textContent = 'Out of Stock';
            statusSpan.classList.add('out-of-stock');
            card.style.opacity = '0.7';
          } else if (stock <= 5) {
            statusSpan.textContent = 'Low Stock';
            statusSpan.classList.add('low-stock');
          } else {
            statusSpan.textContent = 'In Stock';
            statusSpan.classList.add('in-stock');
          }
        });

        // Smooth scroll for new arrivals container
        const container = document.querySelector('.new-arrivals-container');
        let isDown = false;
        let startX;
        let scrollLeft;

        container.addEventListener('mousedown', (e) => {
          isDown = true;
          container.style.cursor = 'grabbing';
          startX = e.pageX - container.offsetLeft;
          scrollLeft = container.scrollLeft;
        });

        container.addEventListener('mouseleave', () => {
          isDown = false;
          container.style.cursor = 'default';
        });

        container.addEventListener('mouseup', () => {
          isDown = false;
          container.style.cursor = 'default';
        });

        container.addEventListener('mousemove', (e) => {
          if (!isDown) return;
          e.preventDefault();
          const x = e.pageX - container.offsetLeft;
          const walk = (x - startX) * 2;
          container.scrollLeft = scrollLeft - walk;
        });
      });
    </script>
  </body>

</html>